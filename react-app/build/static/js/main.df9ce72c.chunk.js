(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{35:function(e,t,a){e.exports=a.p+"static/media/north-west-gate.1fb9d39e.jpg"},36:function(e,t,a){e.exports=a.p+"static/media/north-east-gate.54300b9a.jpg"},37:function(e,t,a){e.exports=a.p+"static/media/north-gate.a2e473f2.jpg"},38:function(e,t,a){e.exports=a.p+"static/media/west-gate.7e955c33.jpg"},39:function(e,t,a){e.exports=a.p+"static/media/central-gate.f33b04f9.jpg"},40:function(e,t,a){e.exports=a.p+"static/media/east-gate.7b6ef059.jpg"},41:function(e,t,a){e.exports=a.p+"static/media/south-west-gate.ff6decff.jpg"},42:function(e,t,a){e.exports=a.p+"static/media/south-gate.25ae3350.jpg"},43:function(e,t,a){e.exports=a.p+"static/media/south-east-gate.04dfecff.jpg"},44:function(e,t,a){e.exports=a.p+"static/media/full-map.a7fcd8c7.jpg"},45:function(e,t,a){e.exports=a(96)},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},82:function(e,t){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(33),r=a.n(s),i=(a(50),a(2)),l=a(3),c=a(5),u=a(4),h=a(6),m=(a(51),function(){function e(t){Object(i.a)(this,e),this.componentName="string"===typeof t?t:t.constructor.name}return Object(l.a)(e,[{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t.splice(0,0,"-"),t.splice(0,0,this.componentName),console.log.apply(console,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t.splice(0,0,"-"),t.splice(0,0,this.componentName),console.error.apply(console,t)}}]),e}()),g=a(1),v=(a(52),a(53),a(34)),d=a.n(v),p=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"init",value:function(){return this.socket||(this.socket=d.a.connect()),this.socket}},{key:"subscribe",value:function(e,t){var a=this;this.logger.log("Subscribing event",e),this.socket.on(e,(function(n){a.logger.log("Receiving data event for",e,n),t(n)}))}},{key:"publish",value:function(e,t){this.logger.log("Emitting event",e,t),this.socket.emit(e,t)}},{key:"onRoll",value:function(e){this.subscribe("roll",e)}},{key:"onLeave",value:function(e){this.subscribe("leave",e)}},{key:"onJoin",value:function(e){this.subscribe("join",e)}},{key:"onImage",value:function(e){this.subscribe("image",e)}},{key:"doPost",value:function(e,t){var a=this;return this.logger.log("Submitting data",e,t),new Promise((function(n,o){fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(t){if(a.logger.log("Reading response for url",e,t),200===t.status)return t.json();throw new Error(t.status)})).then((function(e){return n(e)})).catch((function(e){a.logger.error(e),o(e)}))}))}}]),e}();p.logger=new m("Services");var b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("Login"),a.state={username:"",password:""},a.onSubmit=a.onSubmit.bind(Object(g.a)(a)),a.logout=a.logout.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),p.doPost("/login",this.state).then((function(e){e={type:e.type,id:t.state.username},t.logger.log("Login success",e),t.props.onLoginSuccess&&t.props.onLoginSuccess(e)})).catch((function(){return t.logger.error("Failed to login")}))}},{key:"logout",value:function(e){this.logger.log("Logging out"),this.props.onLogoutSuccess&&this.props.onLogoutSuccess()}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.password;return this.props.user?o.a.createElement("div",{className:"component-login user-login"},o.a.createElement("button",{className:"clear",onClick:this.logout},"Logout")):o.a.createElement("div",{className:"component-login user-logout"},o.a.createElement("form",{onSubmit:this.onSubmit},o.a.createElement("label",null,o.a.createElement("input",{placeholder:"Username",value:a,onChange:function(t){return e.setState({username:t.target.value})}})),o.a.createElement("label",null,o.a.createElement("input",{placeholder:"Password",value:n,onChange:function(t){return e.setState({password:t.target.value})}})),o.a.createElement("input",{className:"save",type:"submit",value:"Login"})))}}]),t}(n.Component),f=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getItem",value:function(e,t){return this.contains(e,t)?(t=t||this.store,JSON.parse(t.getItem(e))):null}},{key:"save",value:function(e,t,a){(a=a||this.store).setItem(e,JSON.stringify(t))}},{key:"remove",value:function(e,t){(t=t||this.store).removeItem(e)}},{key:"contains",value:function(e,t){return(t=t||this.store).hasOwnProperty(e)}},{key:"storage",set:function(e){this.store=e},get:function(){return this.store}}]),e}();f.store=localStorage;a(85);var C=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onClick=a.onClick.bind(Object(g.a)(a)),a.onChangeFile=a.onChangeFile.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onClick",value:function(){this.input.click()}},{key:"onChangeFile",value:function(e){var t=this,a=e.target.files[0],n=window.prompt("Set image title"),o=new FileReader;o.onload=function(){t.props.onChange&&t.props.onChange({src:o.result,alt:n})},o.readAsDataURL(a)}},{key:"render",value:function(){var e=this,t=this.props.children;return o.a.createElement("button",{className:"upload-file",onClick:this.onClick},o.a.createElement("span",null,t),o.a.createElement("input",{ref:function(t){return e.input=t},type:"file",onChange:this.onChangeFile}))}}]),t}(n.Component),k=(a(86),a(87),a(88),function(e){return o.a.createElement("div",{className:"dice-roll-result ".concat(e.first)},o.a.createElement("span",{className:"dice number"},e.roll.number),o.a.createElement("span",{className:"dice operator"},"d("),o.a.createElement("span",{className:"dice value"},e.roll.value),o.a.createElement("span",{className:"dice operator"},") + "),o.a.createElement("span",{className:"dice bonus"},e.roll.bonus),o.a.createElement("span",{className:"dice operator"}," = "),o.a.createElement("span",{className:"dice roll"},e.roll.result))}),O=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("UserRolls"),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.rolls;return this.logger.log("rolls",e),e&&e.length?o.a.createElement("div",{className:"user-rolls"},o.a.createElement("label",null,"Rolls"),e.map((function(e,t){return o.a.createElement(k,{key:t,roll:e,first:0===t?"first":""})}))):null}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("UserSection"),a.onClickImage=a.onClickImage.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onClickImage",value:function(){this.props.onClickImage&&this.props.onClickImage()}},{key:"render",value:function(){var e=this.props.user;return this.logger.log("user",e),o.a.createElement("div",{className:"user-section section-".concat(e.id)},o.a.createElement("fieldset",null,o.a.createElement("legend",null,e.id),o.a.createElement(O,{rolls:e.rolls}),e.image?o.a.createElement("img",{alt:"Remote ".concat(e.id),src:e.image,onClick:this.onClickImage}):null))}}]),t}(n.Component),E=(a(89),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("DiceRoller"),a.state={value:20,number:1,bonus:0},a.values=[4,6,8,10,12,20,100],a.onChangeDiceValue=a.onChangeDiceValue.bind(Object(g.a)(a)),a.onChangeDiceNumber=a.onChangeDiceNumber.bind(Object(g.a)(a)),a.onChangeDiceBonus=a.onChangeDiceBonus.bind(Object(g.a)(a)),a.result=a.result.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onChangeDiceValue",value:function(e){var t=e.target.value;this.setState({value:Number(t)})}},{key:"onChangeDiceNumber",value:function(e){var t=e.target.value;this.setState({number:Number(t)})}},{key:"onChangeDiceBonus",value:function(e){var t=e.target.value;this.setState({bonus:Number(t)})}},{key:"result",value:function(){for(var e=this.state,t=e.value,a=e.number,n=e.bonus,o=0,s=0;s<a;s++)o+=Math.floor(Math.random()*t)+1;o+=n,this.props.onRoll&&this.props.onRoll({value:t,number:a,bonus:n,result:o})}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.number,n=e.bonus,s=this.props.rolls||[];return o.a.createElement("div",{className:"dice-roller"},o.a.createElement("div",{className:"inputs"},o.a.createElement("label",null,o.a.createElement("span",null,"Number"),o.a.createElement("input",{type:"number",min:1,value:a,onChange:this.onChangeDiceNumber})),o.a.createElement("label",null,o.a.createElement("span",null,"Type"),o.a.createElement("select",{onChange:this.onChangeDiceValue},this.values.map((function(e,a){return o.a.createElement("option",{key:a,value:e,selected:e===t},e)})))),o.a.createElement("label",null,o.a.createElement("span",null,"Bonus"),o.a.createElement("input",{type:"number",min:0,value:n,onChange:this.onChangeDiceBonus}))),o.a.createElement("div",{className:"button"},o.a.createElement("button",{className:"save",onClick:this.result},"Roll")),o.a.createElement(O,{rolls:s}))}}]),t}(n.Component)),y=(a(90),a(91),function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getFeatureBonus",value:function(e){return e?Math.floor((e-10)/2):null}}]),e}()),w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={value:""},a.onChange=a.onChange.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onChange",value:function(e){var t=e.target.value,a=Math.floor((t-10)/2);this.setState({value:t,bonus:a}),this.props.onChange&&this.props.onChange({id:this.props.id,value:t})}},{key:"componentDidMount",value:function(){var e=this.props.value||10;this.setState({value:e})}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.label,n=this.state.value,s=y.getFeatureBonus(n);return o.a.createElement("label",{className:"character-feature ".concat(t)},o.a.createElement("label",null,t),o.a.createElement("input",{type:"number",min:1,placeholder:a,value:n,onChange:this.onChange}),o.a.createElement("span",null,s))}}]),t}(n.Component),M=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={character:f.getItem("character")||{features:[{id:"str",label:"Strength"},{id:"dex",label:"Dexterity"},{id:"con",label:"Constitution"},{id:"int",label:"Intelligence"},{id:"wis",label:"Wisdom"},{id:"cha",label:"Charisma"}],extra:""}},a.setText=a.setText.bind(Object(g.a)(a)),a.saveText=a.saveText.bind(Object(g.a)(a)),a.clearText=a.clearText.bind(Object(g.a)(a)),a.setFeature=a.setFeature.bind(Object(g.a)(a)),a.saveFeatures=a.saveFeatures.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"setText",value:function(){var e=this.extra.value,t=this.state.character;t.extra=e,this.setState({character:t})}},{key:"saveText",value:function(){var e=this.extra.value,t=this.state;t.extra=e,f.save("character",t)}},{key:"clearText",value:function(e){this.extra.value=""}},{key:"setFeature",value:function(e){this.state.character.features.find((function(t){return t.id===e.id})).value=e.value,f.save("character",this.state.character)}},{key:"saveFeatures",value:function(){}},{key:"render",value:function(){var e=this,t=this.state.character,a=t.extra,n=t.features;return o.a.createElement("div",{className:"character-sheet"},o.a.createElement("label",null,"Character"),o.a.createElement("div",{className:"features"},n.map((function(t,a){var n=t.id,s=t.label,r=t.value;return o.a.createElement(w,{key:a,id:n,label:s,value:r,onChange:e.setFeature})})),o.a.createElement("button",{className:"save"},"Save")),o.a.createElement("textarea",{value:a,onInput:this.setText,ref:function(t){return e.extra=t}}),o.a.createElement("button",{className:"clear",onClick:this.clearText},"Clear"),o.a.createElement("button",{className:"save",onClick:this.saveText},"Save"))}}]),t}(n.Component),S=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onRoll=a.onRoll.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onRoll",value:function(e){this.props.onRoll&&this.props.onRoll(e)}},{key:"render",value:function(){var e=this.props.user;return o.a.createElement("div",{className:"panel panel-left"},o.a.createElement(E,{onRoll:this.onRoll,rolls:e.rolls}),"player"===e.type?o.a.createElement(M,null):null)}}]),t}(n.Component),I=function(e){return o.a.createElement("img",{alt:e.alt,src:e.src,onLoad:function(t){return e.onImageLoad(t.target)}})},x=(a(92),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("MapLayer"),a.r1=30,a.r2=100,a.density=.4,a.overlay="rgba( 0, 0, 0, 1 )",a.baseMapImage=null,a.onMouseMove=a.onMouseMove.bind(Object(g.a)(a)),a.onMouseDown=a.onMouseDown.bind(Object(g.a)(a)),a.onMouseUp=a.onMouseUp.bind(Object(g.a)(a)),a.getDataImage=a.getDataImage.bind(Object(g.a)(a)),a.onImageLoad=a.onImageLoad.bind(Object(g.a)(a)),a.restoreFog=a.restoreFog.bind(Object(g.a)(a)),a.sendImage=a.sendImage.bind(Object(g.a)(a)),a.showMap=a.showMap.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.contextFog=this.canvasFog.getContext("2d"),this.canvasFog.addEventListener("touchstart",(function(t){var a=t.touches[0],n=a.clientX,o=a.clientY,s=new MouseEvent("mousedown",{clientX:n,clientY:o});e.onMouseDown(s)}),!1),this.canvasFog.addEventListener("touchend",(function(t){var a=new MouseEvent("mouseup",{});e.onMouseUp(a)}),!1),this.canvasFog.addEventListener("touchmove",(function(t){var a=t.touches[0],n=a.clientX,o=a.clientY,s=new MouseEvent("mousemove",{clientX:n,clientY:o});e.onMouseMove(s)}),!1)}},{key:"initContextMap",value:function(){var e=this.canvasFog,t=e.width,a=e.height;this.logger.log("Initializing Fog...",t,a),this.contextFog.fillStyle=this.overlay,this.contextFog.fillRect(0,0,t,a),this.contextFog.globalCompositeOperation="destination-out",this.restoreCanvas=document.createElement("canvas"),this.restoreCanvas.width=t,this.restoreCanvas.height=a,this.restoreContext=this.restoreCanvas.getContext("2d"),this.restoreContext.drawImage(this.canvasFog,0,0)}},{key:"restoreFog",value:function(){this.contextFog.globalCompositeOperation="source-over",this.contextFog.drawImage(this.restoreCanvas,0,0),this.contextFog.globalCompositeOperation="destination-out"}},{key:"sendImage",value:function(){var e=this.getDataImage();this.props.onSendImage&&this.props.onSendImage(e)}},{key:"showMap",value:function(){var e=this.canvasFog,t=e.width,a=e.height;this.contextFog.fillStyle=this.overlay,this.contextFog.fillRect(0,0,t,a)}},{key:"onMouseDown",value:function(e){e.preventDefault(),this.isRemoveFog=!0}},{key:"onMouseUp",value:function(e){e.preventDefault(),this.isRemoveFog=!1}},{key:"onMouseMove",value:function(e){if(e.preventDefault(),this.isRemoveFog){var t=e.clientX,a=e.clientY-this.r2;this.contextFog.fillStyle=this.getMapRadialGradient(t,a),this.contextFog.fillRect(t-this.r2,a-this.r2,2*this.r2,2*this.r2)}}},{key:"getMapRadialGradient",value:function(e,t){var a=this.contextFog.createRadialGradient(e,t,this.r1,e,t,this.r2);return a.addColorStop(0,"rgba( 0, 0, 0,  1 )"),a.addColorStop(this.density,"rgba( 0, 0, 0, .1 )"),a.addColorStop(1,"rgba( 0, 0, 0,  0 )"),a}},{key:"getDataImage",value:function(e){var t=document.createElement("canvas");t.width=this.canvasFog.width,t.height=this.canvasFog.height;var a=t.getContext("2d");return a.drawImage(this.baseMapImage,0,0,this.baseMapImage.width,this.baseMapImage.height,0,0,this.canvasFog.width,this.canvasFog.height),e||a.drawImage(this.canvasFog,0,0),this.restoreContext.drawImage(t,0,0),t.toDataURL("image/png")}},{key:"onImageLoad",value:function(e){this.baseMapImage=e;var t=e.width,a=e.height;this.canvasFog.width=t,this.canvasFog.height=a,this.initContextMap()}},{key:"render",value:function(){var e=this,t=this.props,a=t.image,n=t.alt;return o.a.createElement("div",{className:"map-layer"},o.a.createElement("div",{className:"actions",ref:function(t){return e.actions=t}},o.a.createElement("span",null,n),o.a.createElement("button",{onClick:this.restoreFog},"Cancel"),o.a.createElement("button",{onClick:this.sendImage},"Send"),o.a.createElement("button",{onClick:this.showMap},"Show Map")),o.a.createElement("div",{className:"map-container"},o.a.createElement(I,{alt:n,src:a,onImageLoad:this.onImageLoad}),o.a.createElement("canvas",{id:"canvas-fog",ref:function(t){return e.canvasFog=t},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove})))}}]),t}(n.Component)),N=a(35),F=a.n(N),D=a(36),R=a.n(D),L=a(37),T=a.n(L),U=a(38),Y=a.n(U),X=a(39),B=a.n(X),P=a(40),G=a.n(P),W=a(41),A=a.n(W),J=a(42),V=a.n(J),z=a(43),H=a.n(z),$=a(44),q=a.n($),K=(a(93),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).fullMap={alt:"Full Map",src:q.a},a.list=[{alt:"North West Gate",src:F.a},{alt:"North Gate",src:T.a},{alt:"North Est Gate",src:R.a},{alt:"West Gate",src:Y.a},{alt:"Central Gate",src:B.a},{alt:"Est Gate",src:G.a},{alt:"South West Gate",src:A.a},{alt:"South Gate",src:V.a},{alt:"South East Gate",src:H.a}],a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"map-list"},o.a.createElement("ul",null,this.list.map((function(t,a){return o.a.createElement("li",{key:a,onClick:function(){return e.props.onMapSelected(t)}},o.a.createElement("img",{id:"map-".concat(a),alt:t.alt,src:t.src}))}))),o.a.createElement("img",{alt:this.fullMap.alt,src:this.fullMap.src}))}}]),t}(n.Component)),Q=(a(94),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).isDrawEnabled=!1,a.prevX=0,a.currX=0,a.prevY=0,a.currY=0,a.color="black",a.lineWidth=10,a.drawMode="draw",a.setColor=a.setColor.bind(Object(g.a)(a)),a.resetCanvas=a.resetCanvas.bind(Object(g.a)(a)),a.sendImage=a.sendImage.bind(Object(g.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(g.a)(a)),a.onMouseDown=a.onMouseDown.bind(Object(g.a)(a)),a.onMouseUp=a.onMouseUp.bind(Object(g.a)(a)),a.onMouseOut=a.onMouseOut.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.canvas.width=1024,this.canvas.height=768;var e=this.canvas,t=e.offsetLeft,a=e.offsetTop;this.deltaX=t,this.deltaY=a,this.canvasContext=this.canvas.getContext("2d")}},{key:"onMouseOut",value:function(e){this.isDrawEnabled=!1}},{key:"onMouseUp",value:function(e){this.isDrawEnabled=!1}},{key:"onMouseDown",value:function(e){var t=window,a=t.scrollX,n=t.scrollY;this.prevX=this.currX=parseInt(e.clientX-this.deltaX+a),this.prevY=this.currY=parseInt(e.clientY-this.deltaY+n),this.isDrawEnabled=!0}},{key:"onMouseMove",value:function(e){var t=window,a=t.scrollX,n=t.scrollY;this.currX=parseInt(e.clientX-this.deltaX+a),this.currY=parseInt(e.clientY-this.deltaY+n),this.isDrawEnabled&&(this.canvasContext.beginPath(),"draw"===this.drawMode?(this.canvasContext.globalCompositeOperation="source-over",this.canvasContext.strokeStyle=this.color,this.canvasContext.lineWidth=this.lineWidth):(this.canvasContext.globalCompositeOperation="destination-out",this.canvasContext.lineWidth=3*Number(this.lineWidth)),this.canvasContext.moveTo(this.prevX,this.prevY),this.canvasContext.lineTo(this.currX,this.currY),this.canvasContext.lineJoin=this.canvasContext.lineCap="round",this.canvasContext.stroke(),this.prevX=this.currX,this.prevY=this.currY)}},{key:"setColor",value:function(e){switch(this.drawMode="draw",e.target.className){case"green":this.color="green";break;case"blue":this.color="blue";break;case"red":this.color="red";break;case"yellow":this.color="yellow";break;case"orange":this.color="orange";break;case"white":this.color="white";break;default:this.color="black"}}},{key:"resetCanvas",value:function(){var e=this.canvas,t=e.width,a=e.height;this.canvasContext.fillStyle="white",this.canvasContext.fillRect(0,0,t,a),this.canvasContext.globalCompositeOperation="source-over"}},{key:"getDataImage",value:function(){var e=document.createElement("canvas");return e.width=this.canvas.width,e.height=this.canvas.height,e.getContext("2d").drawImage(this.canvas,0,0),e.toDataURL("image/png")}},{key:"sendImage",value:function(){var e=this.getDataImage();this.props.onSendImage&&this.props.onSendImage(e)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"free-draw"},o.a.createElement("canvas",{ref:function(t){return e.canvas=t},onMouseMove:this.onMouseMove,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseOut:this.onMouseOut}),o.a.createElement("div",{className:"color-chooser",ref:function(t){return e.colorChooser=t}},o.a.createElement("button",{className:"green",onClick:this.setColor},"Green"),o.a.createElement("button",{className:"blue",onClick:this.setColor},"Blue"),o.a.createElement("button",{className:"red",onClick:this.setColor},"Red"),o.a.createElement("button",{className:"yellow",onClick:this.setColor},"Yellow"),o.a.createElement("button",{className:"orange",onClick:this.setColor},"Orange"),o.a.createElement("button",{className:"black",onClick:this.setColor},"Black"),o.a.createElement("button",{className:"white",onClick:this.setColor},"White"),o.a.createElement("button",{className:"eraser",onClick:function(){return e.drawMode="eraser"}},"Eraser"),o.a.createElement("select",{onChange:function(t){return e.lineWidth=t.target.value}},o.a.createElement("option",{value:"2"},"2"),o.a.createElement("option",{value:"10",selected:!0},"10"),o.a.createElement("option",{value:"20"},"20")),o.a.createElement("button",{className:"clear",onClick:this.resetCanvas},"Reset"),o.a.createElement("button",{className:"send",onClick:this.sendImage},"Send")))}}]),t}(n.Component)),Z=(a(95),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={value:f.getItem("note")},a.onSaveText=a.onSaveText.bind(Object(g.a)(a)),a.onClearText=a.onClearText.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"setText",value:function(){var e=this.content.value;this.setState({value:e})}},{key:"onSaveText",value:function(e){var t=this.content.value;f.save("note",t)}},{key:"onClearText",value:function(e){this.content.value=""}},{key:"render",value:function(){var e=this,t=this.state.value;return o.a.createElement("div",{className:"note-section"},o.a.createElement("label",null,"Note"),o.a.createElement("textarea",{value:t,onInput:this.setText,ref:function(t){return e.content=t}}),o.a.createElement("div",{className:"actions"},o.a.createElement("button",{className:"clear",onClick:this.onClearText},"Clear"),o.a.createElement("button",{className:"save",onClick:this.onSaveText},"Save")))}}]),t}(n.Component)),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onSendImage=a.onSendImage.bind(Object(g.a)(a)),a.onMapSelected=a.onMapSelected.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onSendImage",value:function(e){this.props.onSendImage&&this.props.onSendImage(e)}},{key:"onMapSelected",value:function(e){this.props.onMapSelected&&this.props.onMapSelected(e)}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.sourceImage,n=e.sourceAlt,s=e.masterTool;return o.a.createElement("div",{className:"panel panel-center"},"master"===t.type?o.a.createElement("div",{className:"master-tools"},a?o.a.createElement(x,{image:a,alt:n,onSendImage:this.onSendImage}):null,"baldursFateMaps"===s?o.a.createElement(K,{onMapSelected:this.onMapSelected}):null,"freeDraw"===s?o.a.createElement(Q,{onSendImage:this.onSendImage}):null):null,"player"===t.type?o.a.createElement("div",{className:"player-tools"},o.a.createElement(Q,{onSendImage:this.onSendImage})):null,o.a.createElement(Z,null))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onClickImage=a.onClickImage.bind(Object(g.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onClickImage",value:function(){this.props.onClickImage&&this.props.onClickImage()}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.users,s=t.enlargePanelRight;return o.a.createElement("div",{className:"panel panel-right ".concat(s)},n.map((function(t){return t.id!==a.id?o.a.createElement(j,{user:t,onClickImage:e.onClickImage}):null})))}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("Home"),a.state={user:f.getItem("user",sessionStorage),users:[],enlargePanelRight:""},a.onLoginSuccess=a.onLoginSuccess.bind(Object(g.a)(a)),a.onLogoutSuccess=a.onLogoutSuccess.bind(Object(g.a)(a)),a.sendRoll=a.sendRoll.bind(Object(g.a)(a)),a.uploadImage=a.uploadImage.bind(Object(g.a)(a)),a.setBaseMap=a.setBaseMap.bind(Object(g.a)(a)),a.togglePanelRight=a.togglePanelRight.bind(Object(g.a)(a)),a.updateUsers=a.updateUsers.bind(Object(g.a)(a)),p.init(),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;p.onImage((function(t){e.logger.log("Received remote image from user",t.user);var a=e.state.users;a.find((function(e){return e.id===t.user.id})).image=t.image,e.setState({users:a})})),p.onJoin((function(t){return e.updateUsers(t)})),p.onLeave((function(t){return e.updateUsers(t)})),p.onRoll((function(t){return e.updateUsers(t)})),this.state.user&&p.publish("login",this.state.user)}},{key:"updateUsers",value:function(e){this.logger.log("Updating users...",e),this.setState({users:e})}},{key:"sendRoll",value:function(e){var t=this.state.user;t.rolls=t.rolls||[],t.rolls.splice(0,0,e),this.logger.log("Sending roll",e,t),this.setState({user:t});var a=t.id;p.publish("roll",{id:a,rolls:t.rolls})}},{key:"onLoginSuccess",value:function(e){f.save("user",e,sessionStorage),p.publish("login",e),this.setState({user:e})}},{key:"onLogoutSuccess",value:function(){f.remove("user",sessionStorage),p.publish("logout",this.state.user),this.setState({user:null})}},{key:"uploadImage",value:function(e){this.logger.log("Uploading image..."),p.publish("upload",{image:e,user:this.state.user})}},{key:"setBaseMap",value:function(e){this.setState({sourceImage:e.src,sourceAlt:e.alt})}},{key:"togglePanelRight",value:function(){this.setState({enlargePanelRight:this.state.enlargePanelRight?"":"big"})}},{key:"render",value:function(){var e=this,t=this.state,a=t.sourceImage,n=t.sourceAlt,s=t.user,r=t.users,i=t.masterTool,l=t.enlargePanelRight;return this.logger.log("Users",r),o.a.createElement("div",{className:"home"},o.a.createElement("div",{className:"header header-".concat(s?"logout":"login")},o.a.createElement(b,{user:s,onLoginSuccess:this.onLoginSuccess,onLogoutSuccess:this.onLogoutSuccess}),s&&"master"===s.type?o.a.createElement("div",{className:"master-tools"},o.a.createElement("button",{onClick:function(){return e.setState({masterTool:"baldursFateMaps"})}},"Baldur's Gate"),o.a.createElement("button",{onClick:function(){return e.setState({masterTool:"freeDraw",sourceImage:null})}},"Free Draw"),o.a.createElement(C,{onChange:this.setBaseMap},"Upload")):null),s?o.a.createElement("div",{className:"container"},o.a.createElement(S,{user:s,onRoll:this.sendRoll}),o.a.createElement(_,{user:s,sourceImage:a,sourceAlt:n,masterTool:i,onMapSelected:this.setBaseMap,onSendImage:this.uploadImage}),o.a.createElement(ee,{user:s,users:r,enlargePanelRight:l,onClickImage:this.togglePanelRight})):null)}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logger=new m("App"),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(te,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[45,1,2]]]);
//# sourceMappingURL=main.df9ce72c.chunk.js.map